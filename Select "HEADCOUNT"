#### EXEMPLO DE CONSULTA "HEADCONT" MOSTRANDO A SITUAÇÃO DO COLABORADOR EM DETERMINADA COMPETENCIA ####
*Consulta serve para auxiliar na analise de produtividade de determinado setor, informando a quantidade de colaboradores naquele periodo e naquele setor com determinado cargo.
**Consulta tras as seguintes informações:
--Tipo de situação do colaborador
--Qual sua função?
--Qual o seu setor?
--Qual mês de determinado ano?


SELECT 
CONCAT(NMTAB01.CODCOLIGADA,' - ',NMTAB01.NOME)     AS EMPRESA
,NMTAB02.NOME                                      AS NOME_COLABORADOR
,CONVERT(VARCHAR,NMTAB03.DTMUDANCA,3)              AS DT_MUDANCA_FUNCAO
,NMTAB04.NOME                                      AS HIST_FUNCAO
,CONVERT(VARCHAR,NMTAB05.DTMUDANCA,3)              AS DT_MUDANCA_SETOR
,CONCAT(NMTAB06.CODIGO,' - ', NMTAB06.DESCRICAO)   AS HIST_SETOR
,CONVERT(VARCHAR,NMTAB07.DATAMUDANCA,3)            AS DT_MUDANCA_SITUACAO
,NMTAB08.DESCRICAO                                 AS HIST_SITUACAO

FROM NMTAB09
JOIN NMTAB02
	ON NMTAB02.CODIGO = NMTAB09.CODPESSOA
JOIN NMTAB03
	ON NMTAB03.CODCOLIGADA = NMTAB09.CODCOLIGADA AND NMTAB03.CHAPA = NMTAB09.CHAPA
LEFT JOIN NMTAB04
	ON NMTAB04.CODIGO = NMTAB03.CODFUNCAO AND NMTAB04.CODCOLIGADA = NMTAB03.CODCOLIGADA
LEFT JOIN NMTAB01
	ON NMTAB01.CODCOLIGADA = NMTAB09.CODCOLIGADA
LEFT JOIN PMOTMUDFUNCAO
	ON  PMOTMUDFUNCAO.CODINTERNO = NMTAB03.MOTIVO AND PMOTMUDFUNCAO.CODCOLIGADA = NMTAB09.CODCOLIGADA
LEFT JOIN NMTAB05
	ON NMTAB05.CODCOLIGADA = NMTAB09.CODCOLIGADA AND NMTAB05.CHAPA = NMTAB09.CHAPA
LEFT JOIN NMTAB06
	ON NMTAB06.CODIGO = NMTAB05.CODSECAO AND NMTAB06.CODCOLIGADA = NMTAB05.CODCOLIGADA
LEFT JOIN NMTAB07
	ON NMTAB07.CODCOLIGADA = NMTAB09.CODCOLIGADA AND NMTAB07.CHAPA = NMTAB09.CHAPA  
LEFT JOIN NMTAB08
	ON NMTAB08.CODINTERNO = NMTAB07.NOVASITUACAO

WHERE
--AND YEAR(NMTAB05.DTMUDANCA)>=2019 OR YEAR(NMTAB07.DATAMUDANCA)>=2019)

ORDER BY  NMTAB02.NOME
         ,NMTAB03.DTMUDANCA
         ,NMTAB05.DTMUDANCA
         ,NMTAB07.DATAMUDANCA
